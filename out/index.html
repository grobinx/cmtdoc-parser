<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Home</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Home</h1>

    



    


    <h3> </h3>










    




    <section>
        <article><h1>Comment Doc Parser</h1>
<p>A Node.js library to parse documentation comments.<br />
This is a simple library that allows you to parse documentation from one comment.<br />
This module made for parse documentation comments in DPAG template files dedicated DBPAGES web application server.</p>
<h2>Install via npm</h2>
<pre class="prettyprint source"><code>npm install cmtdoc-parser
</code></pre>
<h2>Library usage</h2>
<h3>Describe supported figures</h3>
<pre class="prettyprint source lang-js"><code>const cmtDocParser = require('cmtdoc-parser');

console.log(cmtDocParser.describe());
</code></pre>
<p>or</p>
<pre class="prettyprint source"><code>npm run describe
</code></pre>
<p>The result will be something like this</p>
<pre class="prettyprint source"><code>...

Figure: @version version description
Documents the version number of an item.
Kind: property of string
Example:
@version 1.0.45
@version 0.0.1 Beta
Result:
{
        &quot;version&quot;: &quot;0.0.1 Beta&quot;
}

Figure: @todo text describing thing to do.
Document tasks to be completed.
Kind: array of string
Example:
@todo Write the documentation.
@todo Implement this function.
Result:
{
        &quot;todos&quot;: [
                &quot;Write the documentation.&quot;,
                &quot;Implement this function.&quot;
        ]
}

Figure: @see [namepath|namepath] [description]
Refer to some other documentation for more information.
Kind: array of object
Example:
@see bar
@see bar
@see foo for further information.
@see GitHub
@see &lt;a href=&quot;http://www.link_to_jira/HERO-402&quot;>HERO-402&lt;/a>
@see package.Class#method(Type argname, Type argname,...)
Result:
{
        &quot;see&quot;: [
                {
                        &quot;path&quot;: &quot;bar&quot;
                },
                {
                        &quot;path&quot;: &quot;bar&quot;
                },
                {
                        &quot;path&quot;: &quot;foo&quot;,
                        &quot;description&quot;: &quot;for further information.&quot;
                },
                {
                        &quot;path&quot;: &quot;GitHub&quot;
                },
                {
                        &quot;description&quot;: &quot;&lt;a href=\&quot;http://www.link_to_jira/HERO-402\&quot;>HERO-402&lt;/a>&quot;
                },
                {
                        &quot;path&quot;: &quot;package.Class#method(Type argname, Type argname,...)&quot;
                }
        ]
}

...
</code></pre>
<p>Refer to the <a href="platforms/describe.md">DESCRIBE.md</a> file for information about figures.</p>
<h3>Parse single documentation comment</h3>
<pre class="prettyprint source lang-js"><code>const cmtDocParser = require('cmtdoc-parser');

console.log(cmtDocParser.parse(`/**
    * Parse single documentary comment
    * 
    * I used the resources from the website https://jsdoc.app/ and prepared the regex using the website https://regex101.com/
    * 
    * @author Andrzej Kałuża
    * @created 2025-01-16
    * @version 1.0.0 
    * @module cmtdoc-parser
    */`)
);
</code></pre>
<p>The result will be something like this</p>
<pre class="prettyprint source"><code>{
  description: 'Parse single documentary comment\n' +
    '\n' +
    'I used the resources from the website https://jsdoc.app/ and prepared the regex using the website https://regex101.com/',
  author: { author: 'Andrzej Kałuża' },
  created: '2025-01-16',
  module: { name: 'cmtdoc-parser' },
  version: '1.0.0'
}
</code></pre>
<h2>Extensions usage</h2>
<h3>Parse single file</h3>
<p>This is a simple function that finds and processes comments documenting in file.<br>
This function add property &quot;under&quot; for each found comment for future parse.</p>
<pre class="prettyprint source lang-js"><code>const cmtDocParser = require('cmtdoc-parser');
require('cmtdoc-parser/extensions/parse-file');

console.log(JSON.stringify(cmtDocParser.parseFile(&quot;cmtdoc-parser/index.js&quot;, { under : { name : true } }), null, &quot;\t&quot;));
</code></pre>
<p>The result will be something like this</p>
<pre class="prettyprint source"><code>[
    {
        &quot;description&quot;: &quot;A simple function that finds and processes comments documenting in file\n\nThis function add property under for each found comment for future parse&quot;,
        &quot;parameters&quot;: [
            {
                &quot;type&quot;: &quot;string&quot;,
                &quot;name&quot;: &quot;path&quot;,
                &quot;description&quot;: &quot;path with filename&quot;,
                &quot;types&quot;: [
                    &quot;string&quot;
                ]
            },
            {
                &quot;type&quot;: &quot;json&quot;,
                &quot;name&quot;: &quot;options&quot;,
                &quot;types&quot;: [
                    &quot;json&quot;
                ]
            }
        ],
        &quot;properties&quot;: [
            {
                &quot;type&quot;: &quot;boolean&quot;,
                &quot;name&quot;: &quot;options.under.code&quot;,
                &quot;description&quot;: &quot;returns code founded under comment&quot;,
                &quot;types&quot;: [
                    &quot;boolean&quot;
                ]
            },
            {
                &quot;type&quot;: &quot;boolean&quot;,
                &quot;name&quot;: &quot;options.under.name&quot;,
                &quot;description&quot;: &quot;returns code founded/parsed name under comment&quot;,
                &quot;types&quot;: [
                    &quot;boolean&quot;
                ]
            },
            {
                &quot;type&quot;: &quot;boolean&quot;,
                &quot;name&quot;: &quot;options.matches&quot;,
                &quot;description&quot;: &quot;include matches in documentation structure&quot;,
                &quot;types&quot;: [
                    &quot;boolean&quot;
                ]
            }
        ],
        &quot;returns&quot;: {
            &quot;type&quot;: &quot;json[]&quot;,
            &quot;description&quot;: &quot;array of documentation structures&quot;,
            &quot;types&quot;: [
                &quot;json[]&quot;
            ]
        },
        &quot;under&quot;: {
            &quot;name&quot;: &quot;parseFile&quot;
        }
    }
]
</code></pre>
<h2>Platforms usage</h2>
<h3>PostgreSQL</h3>
<p>Run script platforms/postgresql.js to generate PostgreSQL function parsing jsdoc</p>
<pre class="prettyprint source"><code>npm run postgresql -- out=platforms/postgresql.sql function=jsdoc_parse
</code></pre>
<p>or</p>
<pre class="prettyprint source"><code>node postgresql out=platforms/postgresql.sql function=jsdoc_parse
</code></pre>
<p>As a result you will get jsdoc_parse function in postgresql.sql file to be store in database. Like below...</p>
<pre class="prettyprint source lang-sql"><code>create or replace function jsdoc_parse(str varchar) returns jsonb language plpgsql stable
as $fn$
begin
  str := string_agg(substring(line from '^\s*\*\s*(.*)'), e'\n')
    from (select unnest(string_to_array(str, e'\n')) line) d
   where trim(line) not in ('/**', '*/');
  --
  return jsonb_object_agg(r.figure, r.object)
    from (    -- This is root description
    select 'root' as figure, to_jsonb(r[1]) as object
      from regexp_matches(str, '^([^@]+)') r
    union all
    ...
    -- @callback name
    select 'callback' as figure, to_jsonb(array_agg(r[3])) as object
      from regexp_matches(str, '@(callback)(\s+([^\s@]+))', 'g') r
    having array_agg(r[3]) is not null) r;
end;
$fn$;
</code></pre>
<p>You can use it by executing the query below. I assume that the functions have the js comment contained in the function body, not in the function comment.</p>
<pre class="prettyprint source lang-sql"><code>select p.proname, jsdoc_parse(p.doc) as doc, p.arguments, p.description
  from (select p.proname, substring(pg_get_functiondef(p.oid) from '\/\*\*.*\*\/') as doc, 
               coalesce(pg_get_function_arguments(p.oid), '') arguments,
               d.description
          from pg_proc p
               join pg_namespace n on n.oid = p.pronamespace
               left join pg_description d on d.classoid = 'pg_proc'::regclass and d.objoid = p.oid and d.objsubid = 0
         where n.nspname = :scema_name
           and p.prokind in ('p', 'f')) p
 where p.doc is not null
</code></pre></article>
    </section>






</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-cmtdoc-parser.html">cmtdoc-parser</a></li><li><a href="module-describe-md.html">describe-md</a></li><li><a href="module-parse-file.html">parse-file</a></li><li><a href="module-postgresql.html">postgresql</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Thu Jan 23 2025 19:10:58 GMT+0100 (czas środkowoeuropejski standardowy)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>